--This script assumes the weather_collisions table has already been generated, and creates a full_weather_collisions table which can be saved as a tsv file
CREATE TABLE weather_no_collisions AS
SELECT wc.datetime,wc.borough,wc.zip_code,wc.latitude,wc.longitude,wc.location,wc.on_street,wc.cross_street,wc.off_street,wc.persons_injured,wc.persons_killed,wc.pedestrians_injured,wc.pedestrians_killed,wc.cyclist_injured,wc.cyclist_killed,wc.motorist_injured,wc.motorist_killed,wc.contributing_factor_vehicle_1,wc.contributing_factor_vehicle_2,wc.contributing_factor_vehicle_3,wc.contributing_factor_vehicle_4,wc.contributing_factor_vehicle_5,wc.unique_key,wc.vehicle_type_code_1,wc.vehicle_type_code_2,wc.vehicle_type_code_3,wc.vehicle_type_code_4,wc.vehicle_type_code_5,wc.id,wc.usaf_station_num,wc.wban_station_num,wc.est_time,wc.wind_dir,wc.wind_speed,wc.gust,wc.cloud_ceiling,wc.sky_cover,wc.low_cloud_type,wc.middle_cloud_type,wc.high_cloud_type,wc.visibility,wc.manual_present_weather_1,wc.manual_present_weather_2,wc.manual_present_weather_3,wc.manual_present_weather_4,wc.auto_observed_present_weather_1,wc.auto_observed_present_weather_2,wc.auto_observed_present_weather_3,wc.auto_observed_present_weather_4,wc.past_weather_indicator,wc.temp_farenheit,wc.dewpoint,wc.sea_level_pressure,wc.altimeter,wc.station_pressure,wc.max_temp_farenheit,wc.min_temp_farenheit,wc.liquid_precip_1_hr,wc.liquid_precip_6_hr,wc.liquid_precip_24_hr,wc.liquid_precip_xx_hr,wc.snow_depth,wc.diff,wc.closest,wc.temp_id FROM weather AS w LEFT OUTER JOIN weather_collisions AS wc ON w.est_time=wc.est_time WHERE wc.est_time IS NULL;

SELECT * FROM weather_collisions
UNION ALL
SELECT * FROM weather_no_collisions;
